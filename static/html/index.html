<html>
<head>
	<title>CJ Pais</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://fonts.googleapis.com/css?family=Merriweather" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans" rel="stylesheet">
	<link rel="stylesheet" href="/static/css/sakura.css">
	<link rel="stylesheet" href="/static/css/main.css">
	<link rel="stylesheet" href="/static/css/wa-mediabox.min.css">
	<script type="text/javascript" src="/static/js/luxon.min.js"></script>
	<script type="text/javascript" src="/static/js/vue.min.js"></script>
	<script type="text/javascript" src="/static/js/axios.min.js"></script>
	<script type="text/javascript" src="/static/js/wa-mediabox.min.js"></script>
</head>
<body>
	<a href="/">
		<div id="header" class="header">
			<img src="/static/img/header.jpg"></img>	
			<h2>CJ Pais</h2>
		</div>
	</a>
	<hr>
	<div id="app">
		<!-- TODO CLEAN THIS UP -->
		<!-- THIS IS IF AUTHENTICATED -->
		<template v-if="auth">
			<template v-if="!latestIsToday">
				<!-- TODO LOOK AT NEW PAGE FORM -->
				<form name="newmoment">
					<div class="date-grid pre">
						<input name="tz" class="hidden" v-bind:value="tz"></input>
						<input name="format" class="hidden" value="cjcustom"></input>
						<h3 v-if="newbool"><textarea name="date" class="h3">{{ date }}</textarea></h3>
						<h3 v-else>{{ date }}</h3>
						<div v-on:click="dropclick">
							<button>+</button>
							<div id="dropdown" class="dropdown hidden">
								<a v-on:click="addMoment($event, 'website.post')">Post</a>
								<a v-on:click="addMoment($event, 'website.photo')">Photo</a>
								<a href="/new">New</a>
							</div>
						</div>
					</div>
					<div id="newarea" class="posts hidden">
						<div class="time"><b><textarea name="time" class="bold">{{ newtime }}:</textarea></b></div>
						<post v-if="newtype == 'website.post'" v-bind:n="true"></post>
						<photo v-if="newtype == 'website.photo'"></photo>
						<button>cancel</button>
						<button v-on:click="submitMoment">submit</button>
					</div>
				</form>
			</template>
			<template v-for="(year, yidx) in data">
			<template v-for="(month, midx) in year.Months">
				<template v-for="(day, didx) in month.Days">
					<form name="newmoment">
						<div class="date-grid">
							<input name="tz" class="hidden" v-bind:value="tz"></input>
							<input name="format" class="hidden" value="cjcustom"></input>
							<h3><textarea name="date" class="h3">{{ year.Int | dateformat(month.Int , day.Int ) }}</textarea></h3>
							<div v-on:mouseover="" v-on:click="dropclick" v-on:mouseleave="">
								<button>+</button>
								<div id="dropdown" class="dropdown hidden">
									<a v-on:click="addMoment($event, 'website.post')">Post</a>
									<a v-on:click="addMoment($event, 'website.photo')">Photo</a>
									<a href="/new">New</a>
								</div>
							</div>
						</div>
						<div id="newarea" class="posts hidden">
							<div class="time"><b><textarea name="time" class="bold">{{ newtime }}:</textarea></b></div>
							<post v-if="newtype == 'website.post'" v-bind:n="true"></post>
							<photo v-if="newtype == 'website.photo'"></photo>
							<button>cancel</button>
							<button v-on:click="submitMoment">submit</button>
						</div>
					</form>
					<template v-for="(moment, midx) in day.Moments">
						<div v-for="(post, key) in moment" class="posts">
							<div class="time"><b>{{ post.Time | timeformat }}:</b></div>
							<post v-if="key == 'website.post'" v-bind:post="post"></post>
							<photo v-else-if="key == 'website.photo'" v-bind:post="post"></photo>
								</div>
							</div>
						</template>
					</template>
				</template>
			</template>
		</template>

		<!-- NOT AUTHENTICATED -->
		<template v-else v-for="(year, yidx) in data">
			<template v-for="(month, midx) in year.Months">
				<template v-for="(day, didx) in month.Days">
					<h3>{{ year.Int | dateformat(month.Int , day.Int ) }}</h3>
					<template v-for="(moment, midx) in day.Moments">
						<div v-for="(post, key) in moment" class="posts">
							<div class="time"><b>{{ post.Time | timeformat }}:</b></div>
							<post v-if="key == 'website.post'" v-bind:post="post"></post>
							<photo v-else-if="key == 'website.photo'" v-bind:post="post"></photo>
						</div>
					</template>
				</template>
			</template>
		</template>
	</div>


	<template id="new-moment">

	</template>

	<template id="post-component">
		<div v-if="n">
			<div>
				<textarea class="summary" name="summary" placeholder="Title/Summary" rows="1" v-on:keyup="autosize"></textarea>
				<textarea name="content" placeholder="Post...." rows="1" v-on:keyup="autosize" required></textarea>
				<input hidden name="type" value="website.post"></input>
			</div>
		</div>
		<div v-else-if='post.Summary != ""' class="grid col-1">
			<b class="summary">{{ post.Summary }}</b>
			<div>{{ post.Content }}</div>
		</div>
		<div v-if='post.Summary != ""' class="grid col-1">
			<b class="summary">{{ post.Summary }}</b>
			<div>{{ post.Content }}</div>
		</div>
		<div v-else>
			<div>{{ post.Content }}</div>
		</div>
        </template>

	<template id="photo-component">
		<div v-if='post.Summary != ""' class="grid col-1">
			<b class="summary">{{ post.Summary }}</b>
			<div>
			<a v-bind:href="post.Path" data-mediabox><img v-bind:src="post.Path"></img></a>
			</div>
		</div>
		<div v-else>
			<a v-bind:href="post.Path" data-mediabox><img v-bind:src="post.Path"></img></a>
		</div>
	</template>

	<script type="text/javascript" src="/static/js/main.js"></script>
	</body>
</html>
